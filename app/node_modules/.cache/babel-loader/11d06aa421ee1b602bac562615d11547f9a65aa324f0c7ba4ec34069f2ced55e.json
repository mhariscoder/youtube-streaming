{"ast":null,"code":"var _jsxFileName = \"/home/muhammadharis/projects/youtube-streaming/app/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [broadcastId, setBroadcastId] = useState('');\n  const [mediaStream, setMediaStream] = useState(null);\n  useEffect(() => {\n    const getMediaStream = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true\n        });\n        setMediaStream(stream);\n      } catch (error) {\n        console.error('Error accessing media devices:', error);\n      }\n    };\n    getMediaStream();\n    return () => {\n      if (mediaStream) {\n        mediaStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n  const handleStartBroadcast = async () => {\n    try {\n      const response = await axios.post('http://localhost:5000/start-broadcast');\n      setBroadcastId(response.data.broadcastId);\n      const mediaRecorder = new MediaRecorder(mediaStream);\n      mediaRecorder.ondataavailable = event => {\n        if (event.data.size > 0) {\n          const formData = new FormData();\n          formData.append('video', event.data);\n          // Use the current broadcastId here instead of the state value\n          axios.post(`http://localhost:5000/upload-video?broadcastId=${response.data.broadcastId}`, formData);\n        }\n      };\n      mediaRecorder.start(1000); // Record a chunk every 1 second\n    } catch (error) {\n      console.error('Error starting broadcast:', error);\n    }\n  };\n  const handleGoogleAuth = async () => {\n    try {\n      // Redirect user to backend for Google OAuth2 authentication\n      window.location.href = 'http://localhost:5000/auth/google';\n    } catch (error) {\n      console.error('Error with Google authentication:', error);\n    }\n  };\n  useEffect(() => {\n    // Check if redirected from backend after successful authentication\n    if (window.location.href.includes('http://localhost:5000/auth/google/callback')) {\n      // Perform any necessary actions after authentication (e.g., fetch user data)\n      // For example, you can fetch user data from the backend here\n      console.log('Authenticated successfully!');\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"YouTube Live Streaming\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleGoogleAuth,\n      children: \"Authenticate with Google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleStartBroadcast,\n      children: \"Start Broadcast\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), broadcastId && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Live Stream\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        width: \"560\",\n        height: \"315\",\n        autoPlay: true,\n        controls: true,\n        ref: videoRef => {\n          if (videoRef && mediaStream) {\n            videoRef.srcObject = mediaStream;\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"Rku2vbqKBOZAUDkH5eBZVL4IQI8=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","App","_s","broadcastId","setBroadcastId","mediaStream","setMediaStream","getMediaStream","stream","navigator","mediaDevices","getUserMedia","video","audio","error","console","getTracks","forEach","track","stop","handleStartBroadcast","response","post","data","mediaRecorder","MediaRecorder","ondataavailable","event","size","formData","FormData","append","start","handleGoogleAuth","window","location","href","includes","log","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","width","height","autoPlay","controls","ref","videoRef","srcObject","_c","$RefreshReg$"],"sources":["/home/muhammadharis/projects/youtube-streaming/app/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction App() {\n  const [broadcastId, setBroadcastId] = useState('');\n  const [mediaStream, setMediaStream] = useState(null);\n\n  useEffect(() => {\n    const getMediaStream = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n        setMediaStream(stream);\n      } catch (error) {\n        console.error('Error accessing media devices:', error);\n      }\n    };\n\n    getMediaStream();\n\n    return () => {\n      if (mediaStream) {\n        mediaStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n\n  const handleStartBroadcast = async () => {\n    try {\n      const response = await axios.post('http://localhost:5000/start-broadcast');\n      setBroadcastId(response.data.broadcastId);\n      const mediaRecorder = new MediaRecorder(mediaStream);\n      mediaRecorder.ondataavailable = event => {\n        if (event.data.size > 0) {\n          const formData = new FormData();\n          formData.append('video', event.data);\n          // Use the current broadcastId here instead of the state value\n          axios.post(`http://localhost:5000/upload-video?broadcastId=${response.data.broadcastId}`, formData);\n        }\n      };\n      mediaRecorder.start(1000); // Record a chunk every 1 second\n    } catch (error) {\n      console.error('Error starting broadcast:', error);\n    }\n  };\n\n  const handleGoogleAuth = async () => {\n    try {\n        // Redirect user to backend for Google OAuth2 authentication\n        window.location.href = 'http://localhost:5000/auth/google';\n    } catch (error) {\n        console.error('Error with Google authentication:', error);\n    }\n  };\n\n  useEffect(() => {\n    // Check if redirected from backend after successful authentication\n    if (window.location.href.includes('http://localhost:5000/auth/google/callback')) {\n        // Perform any necessary actions after authentication (e.g., fetch user data)\n        // For example, you can fetch user data from the backend here\n        console.log('Authenticated successfully!');\n    }\n  }, []);\n\n  return (\n    <div>\n      <h1>YouTube Live Streaming</h1>\n      <button onClick={handleGoogleAuth}>Authenticate with Google</button>\n      <button onClick={handleStartBroadcast}>Start Broadcast</button>\n      {broadcastId && (\n        <div>\n          <h2>Live Stream</h2>\n          <video\n            width=\"560\"\n            height=\"315\"\n            autoPlay\n            controls\n            ref={videoRef => {\n              if (videoRef && mediaStream) {\n                videoRef.srcObject = mediaStream;\n              }\n            }}\n          ></video>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,SAASC,GAAGA,CAAA,EAAG;EAAAC,EAAA;EACb,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGR,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACS,WAAW,EAAEC,cAAc,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EAEpDC,SAAS,CAAC,MAAM;IACd,MAAMU,cAAc,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI;QACF,MAAMC,MAAM,GAAG,MAAMC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;UAAEC,KAAK,EAAE,IAAI;UAAEC,KAAK,EAAE;QAAK,CAAC,CAAC;QACtFP,cAAc,CAACE,MAAM,CAAC;MACxB,CAAC,CAAC,OAAOM,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACxD;IACF,CAAC;IAEDP,cAAc,CAAC,CAAC;IAEhB,OAAO,MAAM;MACX,IAAIF,WAAW,EAAE;QACfA,WAAW,CAACW,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;MACxD;IACF,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,oBAAoB,GAAG,MAAAA,CAAA,KAAY;IACvC,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMvB,KAAK,CAACwB,IAAI,CAAC,uCAAuC,CAAC;MAC1ElB,cAAc,CAACiB,QAAQ,CAACE,IAAI,CAACpB,WAAW,CAAC;MACzC,MAAMqB,aAAa,GAAG,IAAIC,aAAa,CAACpB,WAAW,CAAC;MACpDmB,aAAa,CAACE,eAAe,GAAGC,KAAK,IAAI;QACvC,IAAIA,KAAK,CAACJ,IAAI,CAACK,IAAI,GAAG,CAAC,EAAE;UACvB,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;UAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEJ,KAAK,CAACJ,IAAI,CAAC;UACpC;UACAzB,KAAK,CAACwB,IAAI,CAAC,kDAAkDD,QAAQ,CAACE,IAAI,CAACpB,WAAW,EAAE,EAAE0B,QAAQ,CAAC;QACrG;MACF,CAAC;MACDL,aAAa,CAACQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;IAC7B,CAAC,CAAC,OAAOlB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACnD;EACF,CAAC;EAED,MAAMmB,gBAAgB,GAAG,MAAAA,CAAA,KAAY;IACnC,IAAI;MACA;MACAC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,mCAAmC;IAC9D,CAAC,CAAC,OAAOtB,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;IAC7D;EACF,CAAC;EAEDjB,SAAS,CAAC,MAAM;IACd;IACA,IAAIqC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAAC,4CAA4C,CAAC,EAAE;MAC7E;MACA;MACAtB,OAAO,CAACuB,GAAG,CAAC,6BAA6B,CAAC;IAC9C;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,oBACEtC,OAAA;IAAAuC,QAAA,gBACEvC,OAAA;MAAAuC,QAAA,EAAI;IAAsB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC/B3C,OAAA;MAAQ4C,OAAO,EAAEX,gBAAiB;MAAAM,QAAA,EAAC;IAAwB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eACpE3C,OAAA;MAAQ4C,OAAO,EAAExB,oBAAqB;MAAAmB,QAAA,EAAC;IAAe;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,EAC9DxC,WAAW,iBACVH,OAAA;MAAAuC,QAAA,gBACEvC,OAAA;QAAAuC,QAAA,EAAI;MAAW;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACpB3C,OAAA;QACE6C,KAAK,EAAC,KAAK;QACXC,MAAM,EAAC,KAAK;QACZC,QAAQ;QACRC,QAAQ;QACRC,GAAG,EAAEC,QAAQ,IAAI;UACf,IAAIA,QAAQ,IAAI7C,WAAW,EAAE;YAC3B6C,QAAQ,CAACC,SAAS,GAAG9C,WAAW;UAClC;QACF;MAAE;QAAAmC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACI,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAACzC,EAAA,CAnFQD,GAAG;AAAAmD,EAAA,GAAHnD,GAAG;AAqFZ,eAAeA,GAAG;AAAC,IAAAmD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}